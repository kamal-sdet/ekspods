apiVersion: v1
kind: Service
metadata:
  name: jmeter-slaves
  namespace: {{ NAMESPACE | default("jmeter") }}

spec:
  # Headless service required for StatefulSet DNS
  clusterIP: None

  # ðŸ‘‡ CRITICAL FIX â€” allow DNS records BEFORE pod is Ready
  publishNotReadyAddresses: true

  selector:
    app: jmeter-slaves

  ports:
    # ðŸ‘‡ SINGLE RMI PORT USED BY MASTER TO CONNECT TO SLAVES
    - name: rmi
      port: {{ JMETER_RMI_PORT | default(50000) | int }}
      targetPort: {{ JMETER_RMI_PORT | default(50000) | int }}
